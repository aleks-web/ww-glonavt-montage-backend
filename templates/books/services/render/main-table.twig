{#
    request_params - –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞
    services - —É—Å–ª—É–≥–∏
#}

<div class="content-table">
    <div class="content-table__container">

        {% if services | length > 0 %}
            <table>
                <thead>
                    <tr>
                        <th class="text-center" width="10%">‚Ññ –ø/–ø</th>
                        <th class="text-start" style="margin-left: 10px">–ù–∞–∑–≤–∞–Ω–∏–µ —É—Å–ª—É–≥–∏</th>
                        <th class="text-start" style="margin-left: 10px">–û–ø–∏—Å–∞–Ω–∏–µ</th>
                    </tr>
                </thead>

                <tbody>
                    {% for service in services %}
                        <tr>
                            <td class="text-center">{{ service.id }}</td>
                            <td class="text-start">{{ service.name }}</td>
                            <td class="text-start">{{ service.description | default('-') }}</td>
                            
                            <td class="td-btn-default">
                                <svg class="hover" onclick="edit_service({{ service.id }})"><use xlink:href="#svg-edit"></use></svg>
                            </td>

                            <td class="td-btn-default">
                                <svg  class="hover" onclick="delete_service({{ service.id }})"><use xlink:href="#svg-del"></use></svg>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% else %}
            <div style="display: flex; gap: 10px; align-items: center; flex-direction: column; justify-content: center; height: 100%;font-size: 2rem;">
                <span style="font-size: 3rem;">üôÅ</span>
                {% if request_params.control_panel_condition != '' %}
                    <span>–¢–∞–∫–∏—Ö —Ç–∏–ø–æ–≤ —É—Å–ª—É–≥ –Ω–µ –Ω–∞—à–ª–æ—Å—å</span>
                {% else %}
                    <span>–¢–∏–ø–æ–≤ —É—Å–ª—É–≥ –Ω–µ—Ç!</span>
                {% endif %}
                <button data-fancybox data-src="#fmodal-book-new-service" class="btn">–î–æ–±–∞–≤–∏—Ç—å —Ç–∏–ø —É—Å–ª—É–≥–∏</button>
            </div>
        {% endif %}

    </div>
</div>


{# Start —É–¥–∞–ª–µ–Ω–∏–µ —É—Å–ª—É–≥–∏ #}
<script>
    function delete_service(id) {
        let formData = new FormData();
        let url = API_V1_ROUTS.BookServices.delete;

        formData.append('id', id);

        xpost_fd(url, formData).then(response => {
            let mes = response.message ? response.message : '–£—Å–ø–µ—à–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —É—Å–ª—É–≥–∏ (' + url + ')';
            
            dd(response, mes, 'success');
            push(mes, 'success');
            xrender_main_table_book_services();
        }).catch(response => {
            let mes = response.message ? response.message : '–ù–µ—É–¥–∞—á–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —É—Å–ª—É–≥–∏ (' + url + ')';
            
            dd(response, mes, 'error');
            push(mes, 'error');
        });
    }
</script>
{# End —É–¥–∞–ª–µ–Ω–∏–µ —É—Å–ª—É–≥–∏ #}

{# Start –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —É—Å–ª—É–≥–∏ | –ø–æ–¥–≥—Ä—É–∑–∫–∞ –º–æ–¥–∞–ª–∫–∏ #}
<script>
    function edit_service(id) {
        let url = API_V1_ROUTS.BookServices.render + 'fmodal-book-service-update';

        $.ajax({
            url: url,
            method: "POST",
            data: {
                id: id,
                twig_element: 'fmodal-book-service-update.twig',
            },
            success: function (response) {
                if (response.status == "success") {

                    $('#fmodal-book-service-update-wrapper').html(response.render_response_html);

                    $.fancybox.open({
                        src: '#fmodal-book-service-update',
                        type: 'inline'
                    });


                    dd_render_success(
                        response,
                        'books/posts/render/fmodal-book-service-update.twig',
                        url
                    );
                }
            }
        });
    }
</script>
{# End –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —É—Å–ª—É–≥–∏ | –ø–æ–¥–≥—Ä—É–∑–∫–∞ –º–æ–¥–∞–ª–∫–∏  #}